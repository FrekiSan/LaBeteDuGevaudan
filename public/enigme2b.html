
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Énigme 2</title>
  <link rel="icon" href="assets/img/favicon.ico">
  <link rel="stylesheet" href="assets/css/style.css">
  <link rel="stylesheet" href="assets/css/responsive.css">
    <script>
    const correctStates = [1, 1, 1, 0,
                           0, 1, 0, 1,
                           0, 1, 0, 0,
                           1, 1, 0, 0];
    let switches = [];

    document.addEventListener("DOMContentLoaded", () => {
      switches = Array.from(document.querySelectorAll(".switch"));
      switches.forEach((el, i) => {
        el.addEventListener("click", () => toggleSwitch(i));
      });
    });

    function toggleSwitch(index) {
      const el = switches[index];
      const current = el.dataset.state === "1" ? 1 : 0;
      const newState = current === 1 ? 0 : 1;
      el.dataset.state = newState;
      el.textContent = newState;
    }

    function validate() {
      const userState = switches.map(sw => parseInt(sw.dataset.state || "0"));
      const correct = correctStates.every((val, idx) => val === userState[idx]);
      if (correct) {
        const board = document.querySelector(".switch-board");
        if (board) board.style.display = "none";
        document.getElementById("video").style.display = "block";
        setTimeout(() => {
          const __v=document.getElementById("video");if(__v){__v.style.display="block";}
setTimeout,()=>{ window.location.href = "enigme3a.html"; }
        }, 7000);
      } else {
        alert("Mauvaise combinaison !");
      }
    }
  </script>
  <style>
    main {
      text-align: center;
    }
    .switch {
      display: inline-block;
      margin: 10px;
      width: 60px;
      height: 60px;
      font-size: 2em;
      line-height: 60px;
      background-color: #222;
      color: white;
      border: 2px solid #fff;
      cursor: pointer;
      user-select: none;
    }
    .switch-board {
      margin: 30px 0;
    }
    iframe {
      width: 100%;
      max-width: 800px;
      height: 450px;
      display: block;
      margin: 20px auto;
    }
  </style>


<style>
.spoiler-wrap{
  position:relative;
  display:inline-block;
  max-width:100%;
}
.spoiler-wrap img.spoilered{
  filter:blur(14px) brightness(0.7);
  transition:filter .25s ease;
  cursor:pointer;
}
.spoiler-wrap.revealed img.spoilered{
  filter:none;
}
.spoiler-badge{
  position:absolute;
  left:50%;top:50%;
  transform:translate(-50%,-50%);
  padding:.5rem .75rem;
  background:rgba(0,0,0,.7);
  color:#fff;
  border-radius:.5rem;
  font-size:.9rem;
  user-select:none;
  pointer-events:none;
}
.spoiler-hint{
  position:absolute;
  right:.5rem;bottom:.5rem;
  background:rgba(0,0,0,.55);
  color:#fff;
  padding:.25rem .5rem;
  border-radius:.375rem;
  font-size:.75rem;
  pointer-events:none;
  }
</style>
<script>
(function(){
  function shouldSpoiler(img){
    if (!img) return false;
    if (img.dataset && (img.dataset.nospoiler==="1" || img.dataset.nospoiler==="true")) return false;
    var cls = (img.className||"").toLowerCase();
    if (/(logo|favicon|icon)/.test(cls)) return false;
    var src = (img.getAttribute("src")||"").toLowerCase();
    if (/(logo|favicon|icon|header)/.test(src)) return false;
    // Skip very small images (likely UI)
    if (img.naturalWidth && img.naturalWidth < 64) return false;
    // If inside header/nav/footer
    var el = img;
    while (el){
      var tag = (el.tagName||"").toLowerCase();
      var id = (el.id||"").toLowerCase();
      var c = (el.className||"").toLowerCase();
      if (/(header|nav|footer)/.test(tag) || /(header|nav|footer)/.test(id) || /(header|nav|footer)/.test(c)) return false;
      el = el.parentElement;
    }
    return true;
  }
  function wrapSpoiler(img){
    if (img.closest('.spoiler-wrap')) return;
    var wrap = document.createElement('div');
    wrap.className = 'spoiler-wrap';
    var badge = document.createElement('div');
    badge.className = 'spoiler-badge';
    badge.textContent = 'Image masquée';
    var hint = document.createElement('div');
    hint.className = 'spoiler-hint';
    hint.textContent = 'Cliquer pour révéler';
    img.classList.add('spoilered');
    img.parentNode.insertBefore(wrap, img);
    wrap.appendChild(img);
    wrap.appendChild(badge);
    wrap.appendChild(hint);
    wrap.addEventListener('click', function(){
      wrap.classList.toggle('revealed');
    });
  }
  function initSpoilers(){
    var imgs = Array.prototype.slice.call(document.images || []);
    imgs.forEach(function(img){
      if (shouldSpoiler(img)) {
        if (img.complete) {
          wrapSpoiler(img);
        } else {
          img.addEventListener('load', function(){ wrapSpoiler(img); }, {once:true});
        }
      }
    });
  }
  if (document.readyState === 'loading'){
    document.addEventListener('DOMContentLoaded', initSpoilers);
  } else {
    initSpoilers();
  }
})();
</script>

</head>
<body>
  <header>
  <img src="assets/img/logo.png" alt="logo" class="logo">
  <nav class="header-links">
    <a href="#" id="openLogin" data-auth="guest" onclick="openModal('loginModal')">Se connecter</a>
    <a href="#" id="logoutBtn" data-auth="logged" style="display:none;">Se déconnecter</a>
    <a href="#" id="openContact">Contact</a>
    <a href="#" id="openCredits">Crédits</a>
    <a href="#" id="openClassement">Classement</a>
  </nav>
  <span id="timer" style="margin-left:12px;font-weight:bold;"></span>
  </header>

  <h1>Énigme 2</h1>
<div class="spoiler spoiler-block"><img src="assets/img/Fin_Enigme_2_3_5_6/ImageFinalEnigme2-1_Puissance4_.jpg" style="max-width:100%;height:auto" alt="Image indice (spoiler)"></div>


  <div class="video-container">
    <iframe width="560" height="315" src="https://www.youtube.com/embed/Lh2aguSO2Qs"  allowfullscreen></iframe>
  </div>

    <div class="switch-board">
      <div class="switch" data-state="0">0</div>
      <div class="switch" data-state="0">0</div>
      <div class="switch" data-state="0">0</div>
      <div class="switch" data-state="0">0</div><br>
      <div class="switch" data-state="0">0</div>
      <div class="switch" data-state="0">0</div>
      <div class="switch" data-state="0">0</div>
      <div class="switch" data-state="0">0</div><Br>
      <div class="switch" data-state="0">0</div>
      <div class="switch" data-state="0">0</div>
      <div class="switch" data-state="0">0</div>
      <div class="switch" data-state="0">0</div><br>
      <div class="switch" data-state="0">0</div>
      <div class="switch" data-state="0">0</div>
      <div class="switch" data-state="0">0</div>
      <div class="switch" data-state="0">0</div>
      <br>
      <button onclick="validate()">Valider</button>
    </div>

    <div id="video" style="display:none;">
      <iframe src="https://www.youtube.com/embed/mZicG3Ccs9Q" title="Vidéo Histoire 2"  allow="autoplay; encrypted-media" allowfullscreen></iframe>
    </div>

    <footer>
    <!--Preuve vérificator-->
<p>
    <a href="https://jigsaw.w3.org/css-validator/check/referer">
        <img style="border:0;width:88px;height:31px"
            src="https://jigsaw.w3.org/css-validator/images/vcss-blue"
            alt="Valid CSS!" />
    </a>
</p>
  </footer>

<script src="assets/js/utilities.js" defer></script>
<script src="assets/js/manager.js" defer></script>
<script src="assets/js/app.js" defer></script>
<script src="assets/js/classement.js" defer></script>
<script src="assets/js/global_timer.js" defer></script>

</body>
</html>
